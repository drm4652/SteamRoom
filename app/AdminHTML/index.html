<html>
<head>
  <script src="jquery-2.1.4.min.js"></script>
  <link rel="stylesheet" href="tabs.css">
  <script src="../js/Reservation.js"></script>
  <script src="../Multiroom/multiroomFinal.js"></script>
  <script src="../js/Reservation.js"></script>
  <script src="../js/Room.js"></script>
  <script src="../js/User.js"></script>
  <script src="../js/PermissionClass.js"></script>
  <script src="../js/ReservationCreation.js"></script>
  <script src="../Multiroom/mockDBState.js"></script>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
  <link rel="stylesheet" href="multiroom.css">
  <script>
function logout(){
	window.location = "../index.html";
}
function goToReservations(){
	window.location = "../landing.html";
}

  var res1 = new Reservation("drm4652","Active","Individual","2015-11-11 11:00:00", "2", "1561");
  var res2 = new Reservation("qwe1111","Past","Team","2015-11-11 11:00:00", "2", "1563");
  var res3 = new Reservation("drm4652","Active","Individual","2015-11-11 11:00:00", "2", "1565");
  var res4 = new Reservation("req4444","Active","Team","2015-11-11 11:00:00", "2", "1660");
  var res5 = new Reservation("qwe1111","Active","Individual","2015-11-11 11:00:00", "2", "1660");
  var res6 = new Reservation("drm4652","Past","Individual","2015-11-11 11:00:00", "2", "1661");
  
  var resArray = [res1, res2, res3, res4, res5, res6];
  var backupRes = resArray;
  var currentSize = resArray.length;


function resFilterStatus(){
  var userNameCheck = document.getElementById("userNameCheck").checked;
  var resStatusCheck = document.getElementById("resStatusCheck").checked;
  var resTypeCheck = document.getElementById("typeCheck").checked;
  var roomNumCheck = document.getElementById("roomNumCheck").checked;
  var dateCheck = document.getElementById("dateCheck").checked;	
  
  var filters = [userNameCheck, resStatusCheck, resTypeCheck, roomNumCheck, dateCheck];
  return filters;
}

function resFilterValues(){
  var userNameValue = document.getElementById("username").value;
  var resStatusDropDown = document.getElementById("resStatus").value;
  var resTypeDropDown = document.getElementById("resType").value;
  var roomNumValue = document.getElementById("roomNum").value;
  var dateValue = document.getElementById("date").value;
  
  var values = [userNameValue, resStatusDropDown, resTypeDropDown, roomNumValue, dateValue];
  return values;
}

function clearTable(){
    var table = document.getElementById("totalReservations");

	var x = table.rows.length-1;
	
	for(i = x; i >= 0; i--){
		document.getElementById("totalReservations").deleteRow(i);
	}
}

function createMockData(){
/*
  for(i = 0; i < resArray.length;i++){
	addRowFromRes(resArray[i], i);
  }
  */
  
	clearTable();

	var table = document.getElementById("totalReservations");
	var headerRow = table.insertRow(0);
	headerRow.setAttribute("bgcolor", "#98A0A8");	
	
	var userCell = headerRow.insertCell(0);
	var statusCell = headerRow.insertCell(1);
	var typeCell = headerRow.insertCell(2);
	var dateCell = headerRow.insertCell(3);
	var durationCell = headerRow.insertCell(4);
	var roomNumCell = headerRow.insertCell(5);
	var phonelineCell = headerRow.insertCell(6);
	var webcamCell = headerRow.insertCell(7);
		
	userCell.innerHTML = "<b>User</b>";
	statusCell.innerHTML = "<b>Status</b>";
	typeCell.innerHTML = "<b>Type</b>";
	dateCell.innerHTML = "<b>Date</b>";
	durationCell.innerHTML = "<b>Duration</b>";
	roomNumCell.innerHTML = "<b>Room Number</b>";
	phonelineCell.innerHTML = "<b>Phoneline</b>";
	webcamCell.innerHTML = "<b>Webcam</b>";
		
	var counter = localStorage.getItem("numResInTransaction");

	for(i = 1; i <= counter; i++){
		var newRow = table.insertRow(i);
			
		var userCell = newRow.insertCell(0);
		var statusCell = newRow.insertCell(1);
		var typeCell = newRow.insertCell(2);
		var dateCell = newRow.insertCell(3);
		var durationCell = newRow.insertCell(4);
		var roomNumCell = newRow.insertCell(5);
		var phonelineCell = newRow.insertCell(6);
		var webcamCell = newRow.insertCell(7);
			
		userCell.innerHTML = localStorage.getItem("res" + (i-1).toString() + "user");
		statusCell.innerHTML = localStorage.getItem("res" + (i-1).toString() + "status");
		typeCell.innerHTML = localStorage.getItem("res" + (i-1).toString() + "type");
		dateCell.innerHTML = localStorage.getItem("res" + (i-1).toString() + "date");
		durationCell.innerHTML = localStorage.getItem("res" + (i-1).toString() + "duration");
		roomNumCell.innerHTML = localStorage.getItem("res" + (i-1).toString() + "roomNumber");
		
		if(localStorage.getItem("res" + (i-1).toString() + "webcam")=== 'true'){
			phonelineCell.innerHTML = "<img src='phone.png'>";
		}
		if(localStorage.getItem("res" + (i-1).toString() + "phoneLine")=== 'true'){
			webcamCell.innerHTML = "<img src='webcam.png'>";
		}
	}
}

function createTableFromArray(reservations){

  resetTable();

  if(reservations !== 'undefined'){
	  for(i = 0; i < reservations.length; i++){
		addRowFromRes(reservations[i], i);
	  }
  }
}

function filterUsername(reservations){
	var newReservations;

	return newReservations;
}

function filterStatus(reservations){
	var newReservations;

	return newReservations;
}

function filterRoom(reservations){
	var newReservations;

	return newReservations;
}

function filterDate(reservations){
	var newReservations;

	return newReservations;
}

function filterReservations(){
  var finalReservations;
  var filters = resFilterStatus();
  var filterValues = resFilterValues();
  
  finalReservations = resArray;

  resetTable(currentSize);
  
  var res1;
  res1 = [];
  var res2;
  res2 = [];
  var res3;
  res3 = [];
  var res4;
  res4 = [];
  var res5;
  res5 = [];
  
  if(filters[0]){
	if(filterValues[0] != ''){
		for(i = 0; i < resArray.length; i++){
		  if(resArray[i].user == filterValues[0]){
			res1.push(resArray[i]);
		  }
		}
	    finalReservations = res1;
	}
  }
  if(filters[1]){

	if(res1.length == 0){
	  res1 = finalReservations;
	}
		for(i = 0; i < res1.length; i++){
		console.log(filterValues[1]);
			if(res1[i].status == filterValues[1]){
				res2.push(res1[i]);
			}
		}
	finalReservations = res2;
  }
  
  if(filters[2]){
  
	if(res2.length == 0){
	  res2 = finalReservations;
	}
		for(i = 0; i < res2.length; i++){
		console.log(filterValues[2]);
			if(res2[i].type == filterValues[2]){
				res3.push(res2[i]);
			}
		}
	finalReservations = res3;
  }
  if(filters[3]){

	if(res3.length == 0){
	  res3 = finalReservations;
	}
		for(i = 0; i < res3.length; i++){
		console.log(filterValues[3]);
			if(res3[i].roomNum == filterValues[3]){
				res4.push(res3[i]);
			}
		}
	finalReservations = res4;
  }
  if(filters[4]){

  
  }
 
  createTableFromArray(finalReservations);
}

function addRow(){

}

function addRowFromRes(res, i){
    var table = document.getElementById("resTable");
    var row = table.insertRow(i+1);
	
	//var checkboxCell = row.insertCell(0)
    var userCell = row.insertCell(0);
    var statusCell = row.insertCell(1);
    var typeCell = row.insertCell(2);
    var dateCell = row.insertCell(3);
    var durationCell = row.insertCell(4);
    var roomNumCell = row.insertCell(5);
	var operationCell = row.insertCell(6);
	
	//checkboxCell.innerHTML = "<input type='checkbox' id='generatedCheckBox'>";
	//document.getElementById("generatedCheckBox").id = i;
	
    userCell.innerHTML = res.user;
    statusCell.innerHTML = res.status;
    typeCell.innerHTML = res.type;
    dateCell.innerHTML = res.date;
    durationCell.innerHTML = res.duration;
    roomNumCell.innerHTML = res.roomNum;
	operationCell.innerHTML = "<input type='button' id='generatedEdit' value='Edit' onclick='editRow("+i+")'>";
	document.getElementById("generatedEdit").id = "edit" + i;
}

function resetTable(){

    var table = document.getElementById("resTable");

	var x = table.rows.length-1;
	
		for(i = x; i >= 1; i--){
			document.getElementById("resTable").deleteRow(i);
		}
}

function subRow(){
	var checkedRows;
	checkedRows = [];

	for(i = 0; i < resArray.length;i++){
		if(document.getElementById(i).checked){
			checkedRows.push(i);
			document.getElementById("demo").innerHTML = i;
		}
	}
	
	for(i = 0; i < checkedRows.length; i++){
		document.getElementById("resTable").deleteRow(checkedRows[i]+1);
	}
}

function editRow(i){
	console.log("I'm in edit: "+i)
	if(document.getElementById("edit"+i).value == "Edit"){
		document.getElementById("edit"+i).value = "OK";
		
		var table = document.getElementById("resTable");
		table.rows[i+1].cells[1].innerHTML = "<input type='text'>";
		table.rows[i+1].cells[2].innerHTML = "<select id='resStatus'><option value='Active'>Active</option><option value='Past'>Past</option><option value='Future'>Future</option></select>"
		
	}
	else{
		document.getElementById("edit"+i).value = "Edit";
		
		
	}
}

function checkID(i){
	document.getElementById("demo").innerHTML = i;
}

</script>


</head>
<body onload="createMockData()">
<script>
jQuery(document).ready(function() {
    jQuery('.tabs .tab-links a').on('click', function(e)  {
        var currentAttrValue = jQuery(this).attr('href');
 
        // Show/Hide Tabs
        jQuery('.tabs ' + currentAttrValue).show().siblings().hide();
 
        // Change/remove current tab to active
        jQuery(this).parent('li').addClass('active').siblings().removeClass('active');
 
        e.preventDefault();
    });
});
</script>

<input type="button" onclick="logout()" value="<-- Logout">
<input type="button" onclick="goToReservations()" value="Reservations">
<br>
<div class="tabs">
    <ul class="tab-links">
        <li class="active"><a href="#tab1">Reservations</a></li>
        <li><a href="#tab2">Permissions</a></li>
        <li><a href="#tab3">Reports</a></li>
		<li><a href="#tab4">Configuration</a><li>
    </ul>
 
    <div class="tab-content">
        <div id="tab1" class="tab active">
			<style>
			.center {
				margin: auto;
				width: 75%;
				}
			.dropdown {
				margin: auto;
				width: 75%;
				display: inline;
				padding-left: 20px;
				}
			</style>
			
			<div class="center">
			Show only items where:<br><br>
			<input type="checkbox" id="userNameCheck">
			<input type="text" id="username" placeholder="Exact Username"><br>
			<input type="checkbox" id="resStatusCheck">Reservation status
			<div class="dropdown">	
				<select id="resStatus">
					<option value="Active">Active</option>
					<option value="Past">Past</option>
					<option value="Future">Future</option>
				</select>
			</div><br>
			<input type="checkbox" id="typeCheck">Reservation type
			<div class="dropdown">	
				<select id="resType">
					<option value="Individual">Individual</option>
					<option value="Team">Team</option>
				</select>
			</div><br>
			<input type="checkbox" id="roomNumCheck">Room Number
			<div class="dropdown">	
				<select id="roomNum">
					<option value="1560">1560</option>
					<option value="1561">1561</option>
					<option value="1562">1562</option>
					<option value="1563">1563</option>
					<option value="1564">1564</option>
					<option value="1565">1565</option>
					<option value="1660">1660</option>
					<option value="1661">1661</option>
					<option value="1662">1662</option>
					<option value="1663">1663</option>
					<option value="1664">1664</option>
					<option value="1665">1665</option>
				</select>
			</div><br>
			
			<input type="checkbox" id="dateCheck">Date
			<div class="dropdown">	
				<select id="date">
					<option value="Newest">Newest</option>
					<option value="Oldest">Oldest</option>
				</select>
			</div><br>
			<input type="button" value="Filter" onclick="filterReservations()">
			<br><br><br>
			</div>

			<table class="table table-condensed" border=1 width=50% id="totalReservations"></table>
			
			<input type="button" value="Refresh" onclick="createMockData()">
			
			</div>
			

 
        <div id="tab2" class="tab">

			<table border="1" style="width:75%" align="center">
				<tr align="center">
					<td width="3%"></td>
					<td>Name</td>
					<td>Reserve</td>
					<td>Cancel Own</td>
					<td>Cancel Other</td>
					<td>Check-In/Out</td>
					<td>Create/Edit</td>
					<td>Preemption</td>
					<td>Edit</td>
				</tr>
				<tr align="center">
					<td><input type="checkbox"></td>
					<td>Student</td>
					<td>yes</td>
					<td>yes</td>
					<td>no</td>
					<td>yes</td>
					<td>no</td>
					<td>3</td>
					<td><a href="editReservation.html">Edit</a>/<a href="deleteReservation.html">Delete</a></td>
				</tr>
				<tr align="center">
					<td><input type="checkbox"></td>
					<td>Student</td>
					<td>yes</td>
					<td>yes</td>
					<td>no</td>
					<td>yes</td>
					<td>no</td>
					<td>3</td>
					<td><a href="editReservation.html">Edit</a>/<a href="deleteReservation.html">Delete</a></td>
				</tr>
				<tr align="center">
					<td><input type="checkbox"></td>
					<td>Student</td>
					<td>yes</td>
					<td>yes</td>
					<td>no</td>
					<td>yes</td>
					<td>no</td>
					<td>3</td>
					<td><a href="editReservation.html">Edit</a>/<a href="deleteReservation.html">Delete</a></td>
				</tr>
			</table>
			<br><br>
			<div class="center">
				<input type="button" value="Add">
				<input type="button" value="Edit Selected Items">
			</div><br>
        </div>
 
        <div id="tab3" class="tab">
		Reports
		</div>
		
		<div id="tab4" class="tab">
			<fieldset>
				<p><label class="field">Minimum Team Size:</label><input type="text" id="numRooms" size="1" value="" placeholder="   #"></p>
				<div class="error" id="error1"></div>
				<p><label class="field">Maximum Team Size:</label><input type="textbox" id="startDate" size="10" placeholder="MM/DD/YYYY" value=""></p>
				<div class="error" id="error2"></div>
				<p><label class="field">Advance Reservation Time:</label><input type="text" id="endDate" placeholder="MM/DD/YYYY" size="10" value=""></p>
				<div class="error" id="error3"></div>
				<p><label class="field">Maximum Reservation Length:</label>
			</fieldset>
		</div>
    </div>
</div>
</body>


</html>